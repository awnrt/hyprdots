#!/bin/sh

# Show wifi ğŸ“¶ and percent strength or ğŸ“¡ if none.
# Show ğŸŒ if connected to ethernet or â if none.
# Show ğŸ”’ if a vpn connection is active

printconnection() {
  [ "$(cat /sys/class/net/eth0/operstate 2>/dev/null)" = 'up' ] && ethericon="ğŸŒ" || ethericon="â"
  [ -n "$(cat /sys/class/net/wg0/operstate 2>/dev/null)" ] && tunicon=" ğŸ”’"
  printf "%s%s%s\n" "$wifiicon" "$ethericon" "$tunicon"
}

if [ ! -n "$1" ]; then
  printconnection
else
  if [ "$1" -eq 1 ]; then
    if [ ! -n "$(cat /sys/class/net/wg0/operstate 2>/dev/null)" ];then
      doas wg-quick up wg0
      notify-send "ğŸ”’ Internet module" "Connected to VPN"
    else
      doas wg-quick down wg0
      notify-send "ğŸ”’ Internet module" "Disconnected from VPN"
    fi
  elif [ "$1" -eq 3 ]; then
    notify-send "ğŸŒ Internet module" "\- Click to connect to vpn"
  fi
fi
